<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
  <style>
    .red-dot-header {
      width: 12px;
      height: 12px;
      background-color: rgb(92, 223, 35);
      border-radius: 50%;
      display: inline-block;
      position: absolute;
      top: 0;
      right: 0;
    }

    .header-icon {
      width: 28px;
    }

    .header {
      font-family: 'Roboto', sans-serif;
    }
  </style>
</head>
<header class="md:mb-[76px]">
  <div
    class="flex flex-col items-center justify-center  md:flex-row top-0 left-0 w-full  fixed  bg-white md:border-b border-gray-300">
    <div class="w-1/6 flex items-center justify-center md:justify-start">
      <a href="/" class="flex">
        <img src="/img/logo1.svg" alt="你的智友" class=" w-[60px] mx-auto mt-5 md:mt-0 md:ml-6 md:p-2 ">

        <!-- <img src="/img/logo3.svg" alt="你的智友" class=" w-[120px] mx-auto mt-5 md:mt-0  md:p-2 "> -->
        <a href="/"
          class="header first-line:m-2 p-1 md:tracking-[2px] text-[26px] text-gray-900 font-semibold ">n'aLone</a></a>
    </div>

    <!-- menu -->
    <div class="w-2/6 flex items-center justify-center md:justify-start">
      <nav>
        <ul class="flex items-center justify-center">
          <a href="/about" class="mx-1 md:mx-5 text-[10px]  md:text-[17px] md:tracking-[2px] hover:text-red">關於我們</a>
          <a href="/articles"
            class="mx-1 md:mx-5 text-[10px]  md:text-[17px]  md:tracking-[2px]  hover:text-red ">智友記事</a>
        </ul>
      </nav>
    </div>

    <!-- search bar and icon -->

    <div class="w-3/6 flex items-center justify-center md:justify-end mt-3 mb-1 md:my-3 md:mr-2 md:pr-5 ">
      <!-- search bar border: use flex to let children be flex in a row-->
      <form action="/api/v1/search/articles">
        <div
          class="flex items-center justify-center md:py-1 md:px-2 md:mr-8 rounded-full border border-gray-300 border-1">
          <!-- search bar text  -->
          <div class="w-4/6">
            <input
              class="flex-1 pl-2 md:px-4 md:py-2 font-thin rounded-full outline-none text-gray-300 md:text-m tracking-widest"
              type="text" placeholder="搜尋智友" name="keyword">
          </div>
          <!-- icon  -->
          <div class="w-2/6 flex items-center justify-end">
            <button type="submit">
              <a href="#" class="flex items-center justify-end">
                <img src="/img/search.png" alt="search icon" class="w-5 h-5 md:w-8 md:h-8">
              </a>
            </button>
          </div>
        </div>
      </form>

      <div class="mr-6 hidden md:block relative" id="messageIcon">
        <a href="/chatroom">
          <img class="header-icon" src="/img/messenger.svg" alt="message">
        </a>
        <span id="red-dot-header"></span>
      </div>

      <div class="mr-6 hidden md:block ">
        <a href="/user/profile">
          <img src="/img/member.svg" class="header-icon" alt="">
        </a>
      </div>
      <div class="hidden md:block">
        <a href="/user/signin" class=" hover:bg-blue bg-red rounded-full relative button-wrap
          ">
          <div class="flex items-center justify-center w-[120px] h-[40px]  text-white md:text-[14px] md:tracking-[2px] 
          ">成為智友</div>
          <div class="btn-overlay w-[120px] h-[40px]"></div>
        </a>

      </div>

      <style>
        .button-wrap {
          align-self: center;
          transition: all .5s;
          display: inline-block;
          position: relative;
        }

        .btn-overlay {
          z-index: -1;
          width: 100%;
          height: 100%;
          background-color: black;
          border-radius: 30px;
          display: block;
          position: absolute;
          top: 3px;
          left: 2px
        }
      </style>

    </div>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
      const senderId = localStorage.getItem('userId');
      let socket
      if (senderId) {
        socket = io({
          auth: (cb) => {
            cb({ userId: senderId })
          }
        })
        socket.emit('joinMyRoom', String(senderId));
      }

      socket.on("message", function (data) {
        // 如果網址有room,id的邏輯，會因應點擊右方list調整所以使用let
        const messageIcon = document.getElementById('red-dot-header');
        messageIcon.classList.add('red-dot-header')
      })

      messageIcon.addEventListener('click', function () {
        messageIcon.removeChild('red-dot-header');
      });

    </script>

</header>